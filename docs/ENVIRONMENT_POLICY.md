# ENVIRONMENT_POLICY.md

본 문서는 EMS에서 사용하는 **발전소 환경 기준 정책(Environment Policy)** 을 정의한다.  
본 정책은 온습도계 판단, 배터리 충·방전 가능 여부, 에어컨 자동 제어 판단의
**상위 기준 문서**이다.

---

## 1. 정책 적용 범위

본 정책은 다음 대상에 적용된다.

- 온습도계 상태 판단
- 배터리 충·방전 운전 가능 여부 판단
- 에어컨 자동 제어(AUTO 모드) 판단 기준

⚠️ 본 정책은 **장비 설정이 아닌, 발전소 운영 정책**이다.

---

## 2. 발전소별 정책 원칙

- 환경 기준은 **발전소 단위로 다르게 설정될 수 있다**
- 동일 EMS라도 발전소별로 다른 기준으로 운전 판단을 수행한다

예시:

| 발전소 | 온도 기준 (℃) | 습도 기준 (%) |
|------|---------------|---------------|
| A 발전소 | 18 ~ 28 | ≤ 80 |
| B 발전소 | 15 ~ 30 | ≤ 70 |
| C 발전소 | 20 ~ 26 | ≤ 75 |

---

## 3. 기본 환경 기준 (초기값)

환경 기준값은 TEMPERATURE_HUMIDITY_MODEL.md에 정의된 값을 사용한다.

본 문서는 해당 기준을
- 충·방전 제어 허용 여부 판단
- AUTO 제어 판단
  에 어떻게 적용하는지만 정의한다.

---

## 환경 상태 모델 (고정)

환경 상태는 다음 두 가지로만 정의한다.

- OPERABLE
    - 의미: 충·방전 운전 가능
    - 조건: 환경 기준 만족

- NOT_OPERABLE
    - 의미: 충·방전 운전 불가
    - 조건: 기준 이탈 또는 데이터 유효하지 않음

⚠️ WARNING / PARTIAL / FAULT 와 같은
장비 상태 용어는 환경 상태에 사용하지 않는다.

---

## 4. 충·방전 운전 가능 판단 기준

다음 조건을 **모두 만족**할 경우에만  
환경 상태를 OPERABLE 로 판단한다.

- 온도 ≥ 기준 최소 온도
- 온도 ≤ 기준 최대 온도
- 습도 ≤ 기준 최대 습도
- 온습도계 데이터 유효 (통신 정상)

조건 미충족 시:
- 환경 상태: NOT_OPERABLE
- 사유: **온습도 기준 이탈**

---

## 5. 온습도계와의 관계

- 온습도계는 **Read-Only 장비**
- EMS는 온습도계를 직접 제어하지 않는다
- 온습도계 설정 기능은 EMS 범위에 포함하지 않는다

---

## 6. 에어컨 제어와의 관계

본 정책은 **에어컨 자동 제어(AUTO 모드)** 판단 기준으로 사용된다.

- AUTO 모드:
    - EMS가 본 정책을 기준으로 에어컨을 능동 제어
- MANUAL 모드:
    - 본 정책은 **판단용으로만 사용**
    - EMS는 에어컨 제어에 개입하지 않는다

---

## 7. 정책 변경 권한

- 정책 변경 권한: **관리자(Admin)**
- 현장 엔지니어:
    - 정책 변경 불가
    - 에어컨 제어만 가능

---

## 8. 우선순위

본 문서의 정책은 다음 문서보다 우선한다.

1. UI_CONTRACT.md
2. DEVICE_STATUS_MODEL.md
3. SERVICE_LAYER_POLICY.md

본 문서와 충돌하는 구현은 허용하지 않는다.

---

## 9. 상태 모델과의 관계 (중요)

본 환경 정책은
OperationStatus / FaultStatus와 같은
**장비 상태를 직접 생성하거나 변경하지 않는다.**

환경 기준은:
- 충·방전 제어 허용 여부 판단
- AUTO 제어 가능 여부 판단

에만 사용되며,
장비의 정상/고장 판단에는 관여하지 않는다.

---

# ENVIRONMENT_POLICY.md

본 문서는 EMS에서 사용하는 **발전소 환경 기준 정책(Environment Policy)** 을 정의한다.  
환경 정책은 개별 설비의 상태를 종합하여  
**배터리 충·방전 운전 가능 여부를 판단하는 최상위 기준**이다.

본 문서는 UI, Backend(Service / Provider), Scheduler, 제어 로직에서  
**단일 기준(Single Source of Truth)** 으로 사용된다.

---

## 10. 정책 적용 범위

본 정책은 다음 대상에 적용된다.

- 온습도계 상태 판단
- 배터리 충·방전 운전 가능 여부 판단
- 에어컨 자동 제어(AUTO 모드) 판단 기준
- 환경 이상 알람 및 이력 기록

---

## 11. 환경 판단의 기본 원칙

1. 환경 판단은 **개별 장비 상태가 아닌, 정책 기준에 의해 수행된다**
2. 하나의 환경 이상도 **충·방전 전체를 정지시킬 수 있다**
3. 환경 정보가 불확실한 경우, **보수적으로 운전 정지**한다

---

## 12. 온습도계 환경 판단 정책

### 12.1 참조 모델

온습도계의 상태 해석 및 판단 로직은  
다음 문서를 **절대 기준**으로 따른다.

- **TEMPERATURE_HUMIDITY_MODEL.md**

본 문서와 충돌하는 임의의 판단 로직은 허용하지 않는다.

---

### 12.2 채널 기반 판단 원칙

- 온습도계는 다중 채널(CH)을 가질 수 있다
- 채널 단위 상태는 **참고 정보**이며
- **운전 판단은 전체 채널 집계 결과를 기준으로 한다**

---

### 12.3 충·방전 운전 판단 기준

다음 조건 중 **하나라도 만족하면 충·방전 운전을 정지**한다.

#### ① 환경 정보 수신 불가
- 모든 온습도계 채널이 통신 불가인 경우
- 배터리 룸 환경을 판단할 수 없다고 간주

#### ② 환경 기준 초과
- 정상 통신 채널 중
    - 온도 < 기준온도Min
    - 온도 > 기준온도Max
    - 습도 > 기준습도Max
- **채널 개수와 무관하게 1개라도 기준 초과 시 즉시 정지**

---

### 12.4 운전 가능 조건

다음 조건을 **모두 만족해야만** 충·방전 운전이 가능하다.

- 하나 이상의 온습도계 채널이 통신 정상
- 모든 정상 통신 채널이 기준 범위 내

---

## 13. 에어컨 자동 제어와의 관계

- 에어컨 AUTO 제어 판단은 본 환경 정책의 **하위 정책**이다
- 충·방전이 정지된 상태에서는
    - 에어컨은 **환경 복구 목적의 능동 대응**만 수행할 수 있다
- 에어컨 제어 상세 정책은 다음 문서를 따른다.

- AIR_CONDITIONER_OPERATION_POLICY.md

---

## 14. UI 및 상태 표현 원칙

- 환경 이상은 반드시 **원인이 명확히 드러나야 한다**
- “주의”와 같은 추상적 표현은 사용하지 않는다
- 환경 이상 시 UI 표준 상태 텍스트:
    - 환경 이상 (충·방전 정지)
    - 환경 정보 수신 불가

색상 및 표현 규칙은 다음 문서를 따른다.

- UI_STATUS_COLOR_POLICY.md

---

## 15. 변경 이력

- 2026-01-01
    - ENVIRONMENT_POLICY 초안 작성
    - 온습도 기준을 장비 상태와 분리하여 환경 정책으로 독립

### v1.1 (2026-01-02)
- 온습도계 환경 판단을 TEMPERATURE_HUMIDITY_MODEL.md 기준으로 통합
- 다중 채널 집계 기반 충·방전 정지 정책 확정
- 환경 정보 수신 불가 조건 명문화

---



